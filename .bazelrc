# Keep the build tree under ./build/
build --symlink_prefix=build/bazel-

# C++ standard & warnings (apply to host & target)
build --cxxopt=-std=c++20
build --host_cxxopt=-std=c++20
build --cxxopt=-Wall
build --cxxopt=-Wextra
build --cxxopt=-Werror
build --cxxopt=-Wpedantic
build --cxxopt=-Wshadow
build --cxxopt=-Wconversion
build --cxxopt=-Wsign-conversion
build --cxxopt=-Wnon-virtual-dtor
build --cxxopt=-Wold-style-cast
build --cxxopt=-Wcast-align
build --cxxopt=-Wunused
build --cxxopt=-Woverloaded-virtual
build --cxxopt=-Wformat=2

# Compiler-specific toggles
build:gcc   --repo_env=CC=gcc
build:gcc   --repo_env=CXX=g++
build:gcc   --cxxopt=-fdiagnostics-color=always

build:clang --repo_env=CC=clang
build:clang --repo_env=CXX=clang++
build:clang --cxxopt=-fcolor-diagnostics

# Build modes (your script supplies --config=debug or --config=release)
build:debug   --compilation_mode=dbg --copt=-O0 --copt=-g3 --strip=never
build:release --compilation_mode=opt --copt=-O3 --copt=-DNDEBUG --strip=always

# General niceties
build --verbose_failures
build --announce_rc
common --color=yes

# Test output
test --test_output=errors
test --test_summary=detailed

